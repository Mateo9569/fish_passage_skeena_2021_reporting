---
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup-198066, eval = F}
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE)
source('scripts/packages.R')
source('scripts/tables.R')



```



```{r  load-data-198066}
my_site <- 198066
my_site2 <- 123377


```

`r fpr::fpr_appendix_title(site2 = my_site2)`

## Site Location {-}

PSCIS crossing `r as.character(my_site)` and `r as.character(my_site2)` are located on `r fpr::fpr_my_pscis_info()` midway between Telkwa and Houston. PSCIS crossing `r as.character(my_site)` is located on a small private road and `r as.character(my_site2)` is located on `r fpr_my_pscis_info(site = my_site2, col_pull = road_name)`.  Crossing `r as.character(my_site)` was located `r round(fpr::fpr_my_bcfishpass(col_pull = downstream_route_measure)*0.001, 1)`km upstream from the confluence with a side channel of the Bulkley River and `r as.character(my_site2)` was located `r round(fpr::fpr_my_bcfishpass(site = my_site2, col_pull = downstream_route_measure)*0.001, 1)`km upstream of the confluence. Crossing `r as.character(my_site)` was on private land owned by Jeremy Rouw and hay fields as well as other infrastructure that was part of Udder View Dairy were located upstream of the crossing. Crossing `r as.character(my_site2)` is the responsibility of the Ministry of Transportation and Infrastructure.


<br>

## Background {-}


At crossing `r as.character(my_site)`, `r fpr::fpr_my_pscis_info()` is a `r fpr::fpr_my_bcfishpass() %>% english::ordinal()` order stream with a watershed area upstream of the crossing of approximately `r fpr::fpr_my_wshd()`km^2^. The elevation of the watershed ranges from a maximum of `r fpr::fpr_my_wshd(col = 'elev_max')`m to `r fpr::fpr_my_wshd(col = 'elev_min')`m near the crossing (Table \@ref(tab:tab-wshd-198066)). Upstream of crossing `r as.character(my_site)`, `r fpr::fpr_my_fish_sp()` have previously been recorded [@moe2020KnownBC; @norris2020bcfishobs]. 

<br>

Landowners adjacent to the stream at both crossings as well as regional DFO staff report that Thompson Creek was historically redirected from its original channel on the height of land near the Bulkley River in the 1960s.  The historic channel is  visible in aerial imagery and would have directed flows in a north-eastern direction from where the agricultural fields meet the Thompson creek valley. The redirection diverts the channel into two seperate channels that flow south-east.  The main flow of the channel was flowing in an excavated trench through the hay field at the time of the survey.  The distance from the current confluence with the Bulkley River side channel to the historic valley is approximately 370m.  The distance the stream would have traveled historically in a north-eastern direction is estimated at 1300m. The landowner reported that conceptually they would like to see the stream redirected to its historic channel.  They noted that stranding has been observed within the excavated channel and a realignment would help prevent the loss of hay production caused by the high water table adjacent to the excavated channel. A map of the current man made channels and the historic channel is provided in Figure \@ref(fig:fig-channel-198066).  Adjacent landowners also report that the crossing at Walcott Road had nearly washed out at the road due to high flows related to beaver dam failures.  Crossing 123378 has been recorded as a bridge on Thompson Creek on the BC Hydro powerline between `r as.character(my_site)` and `r as.character(my_site2)` [@gollner_cain2014FISHPASSAGE].  Landowners report this bridge washed out at the time of the beaver dam failure and was replaced in 2020.

<br>

```{r tab-wshd-198066, fig.cap= 'Map of current man made channels and historic channel on Thompson Creek near Bulkley River mainstem.',  eval = T}
fpr::fpr_table_wshd_sum(site_id = my_site) %>% 
  fpr::fpr_kable(caption_text = paste0('Summary of derived upstream watershed statistics for PSCIS crossing ', my_site, '.'),
           footnote_text = 'Elev P60 = Elevation at which 60% of the watershed area is above',
           scroll = F)

```

<br>



```{r fig-channel-198066, eval = T, fig.cap= 'Map of the current man made channels and the historic channel on Thompson Creek adjacent to the Bulkley River.'}
knitr::include_graphics("fig/thompson.png")
```

<br>

@tamblyn_jessop2000DetailedFish have documented detailed fish habitat, riparian and channel assessment data for Reach 1 and 2 of the stream surveying 12.6km along with an impact synopsis and restoration suggestions.

<br>

PSCIS stream crossing `r as.character(my_site2)` was ranked as a high priority for follow up by @irvine2018AnalysisPriority and @smith2018AssessingBarriers because of the relatively large size of the stream and habitat rated as high value in PSCIS (Table \@ref(tab:tab-culvert-bcfp-198066).  A map of the watershed is provided in map attachment [`r fpr::fpr_my_bcfishpass(col_pull = dbm_mof_50k_grid)`](`r fpr::fpr_my_mapsheet()`).  


`r if(identical(gitbook_on, FALSE)){knitr::asis_output("\\pagebreak")}`

<br>


```{r tab-culvert-bcfp-198066, eval = T}
fpr::fpr_table_bcfp(scroll = gitbook_on) 

```

<br>


## Stream Characteristics at Crossing {-}

At the time of the survey, PSCIS crossing `r as.character(my_site)` was un-embedded, non-backwatered and ranked as a `r fpr::fpr_my_pscis_info(col_pull = barrier_result) %>% stringr::str_to_lower()` barrier to upstream fish passage according to the provincial protocol [@moe2011Fieldassessment]. There was rip rap placed around the culvert inlets and outlets (Table \@ref(tab:tab-culvert-198066)). Water temperature was `r fpr::fpr_my_habitat_info(sit = my_site2, col_pull = 'temperature_c')`$^\circ$C, pH was `r fpr::fpr_my_habitat_info(sit = my_site2, col_pull = 'p_h')` and conductivity was `r fpr::fpr_my_habitat_info(sit = my_site2, col_pull = 'conductivity_m_s_cm')`uS/cm. 


<br>

```{r tab-culvert-198066, eval = T}
fpr::fpr_table_cv_summary_memo()

```

<br>

```{r tab-culvert-198066-site2, eval = T}
fpr::fpr_table_cv_summary_memo(site = my_site2, site_photo_id = my_site2)

```


```{r eval=F}
##this is useful to get some comments for the report
hab_site %>% filter(site == my_site & location == 'ds') %>% pull(comments)
my_priority <-  my_priority_info()


```

## Stream Characteristics Downstream {-}

The stream was surveyed downstream from the culvert for `r fpr::fpr_my_priority_info(loc = 'ds', col_pull = 'length_surveyed')`m `r if(gitbook_on){knitr::asis_output("(Figures \\@ref(fig:photo-198066-01) - \\@ref(fig:photo-198066-02))")}else(knitr::asis_output("(Figure \\@ref(fig:photo-198066-d01))"))`. Total cover amount was rated as `r fpr::fpr_my_habitat_cover(loc = 'ds', cover_type = 'total cover')` with  `r fpr::fpr_my_habitat_cover(loc = 'ds', cover_type = 'dominant')` dominant. Cover was also present as `r fpr::fpr_my_habitat_cover(loc = 'ds', cover_type = 'sub-dominant')` (Table \@ref(tab:tab-habitat-summary-198066)). The average channel width was `r fpr::fpr_my_habitat_info(loc = 'ds', col_pull = 'avg_channel_width_m')`m, the average wetted width was `r fpr::fpr_my_habitat_info(loc = 'ds', col_pull = 'avg_wetted_width_m')`m and the average gradient was `r fpr::fpr_my_habitat_info(loc = 'ds', col_pull = 'average_gradient_percent')`%. The dominant substrate was `r fpr::fpr_my_habitat_info(loc = 'ds', col_pull = "bed_material_dominant")` with `r fpr::fpr_my_habitat_info(loc = 'ds', col_pull = "bed_material_subdominant")` subdominant.  The habitat was rated as `r fpr::fpr_my_priority_info(loc = 'ds')` value for salmonid rearing and spawning. 

<br>

## Stream Characteristics Upstream of `r as.character(my_site)` and downstream of `r as.character(my_site2)`{-}


The stream was surveyed immediately upstream from `r as.character(my_site)` for approximately `r fpr::fpr_my_priority_info(col_pull = 'length_surveyed')`m `r if(gitbook_on){knitr::asis_output("(Figures \\@ref(fig:photo-198066-03) - \\@ref(fig:photo-198066-04))")} else(knitr::asis_output("(Figure \\@ref(fig:photo-198066-d02))"))`. Within the area surveyed, total cover amount was rated as `r fpr::fpr_my_habitat_cover(loc = 'us', cover_type = 'total_cover')` with  `r fpr::fpr_my_habitat_cover(loc = 'us', cover_type = 'dominant')` dominant. Cover was also present as `r fpr::fpr_my_habitat_cover(loc = 'us',cover_type = 'sub-dominant')` (Table \@ref(tab:tab-habitat-summary-198066)). The average channel width was `r fpr::fpr_my_habitat_info(loc = 'us', col_pull = 'avg_channel_width_m')`m, the average wetted width was `r fpr::fpr_my_habitat_info(loc = 'us', col_pull = 'avg_wetted_width_m')`m and the average gradient was `r fpr::fpr_my_habitat_info(loc = 'us', col_pull = 'average_gradient_percent')`%.  The dominant substrate was `r fpr::fpr_my_habitat_info(loc = 'us', col_pull = "bed_material_dominant")` with `r fpr::fpr_my_habitat_info(loc = 'us', col_pull = "bed_material_subdominant")` subdominant. Habitat value was rated as `r fpr::fpr_my_priority_info()` value for resident salmonid rearing and spawning. 




## Structure Remediation and Cost Estimate {-}

Should restoration/maintenance activities proceed at the site, replacement of PSCIS crossing `r as.character(my_site)` with a bridge (`r fpr::fpr_my_pscis_info(col_pull = recommended_diameter_or_span_meters)`m span) is recommended. 

```{r}
# The cost of the work is estimated at \$`r format(my_cost_estimate() %>% pull(cost_est_1000s) * 1000, big.mark = ',')` for a cost benefit of `r as.character(my_cost_estimate() %>% pull(cost_net))` linear m/\$1000 and `r as.character(my_cost_estimate() %>% pull(cost_area_net))`m^2^/\$1000. 

```

<br>


## Conclusion {-}

There was`r fpr::fpr_my_priority_info(col_pull= upstream_habitat_length_km)`km of habitat modelled upstream of crossing `r as.character(my_site)` rated as `r fpr::fpr_my_priority_info(sit = my_site, loc = 'us', col_pull = hab_value)` value for salmonid rearing and spawning. Crossing `r as.character(my_site)` was ranked as a `r fpr::fpr_my_priority_info(col_pull = priority)` priority for proceeding to design for replacement. 

<br>

There was `r fpr::fpr_my_priority_info(sit = my_site2, col_pull= upstream_habitat_length_km)`km of habitat upstream of crossing `r as.character(my_site2)` rated as `r fpr::fpr_my_priority_info(sit = my_site2, loc = 'us', col_pull = hab_value)` value for salmonid rearing and spawning. Crossing `r as.character(my_site2)` was ranked as a `r fpr::fpr_my_priority_info(col_pull = priority)` priority for proceeding to design for replacement. 

<br>

Restoration suggestions by @tamblyn_jessop2000DetailedFish can be considered still relevant for Thompson Creek and include working with landowners to limit cattle access to the riparian zone, re-establishing riparian vegetation, improving cattle crossings and fish passage at roads.  Additionally, the redirection of the stream back into it's historic channel on the north side of the agricultural field near the confluence with the Bulkley River provides an extraordinary opportunity for sizable fish habitat gains in a currently very severely impacted section of stream.  

`r if(gitbook_on){knitr::asis_output("<br>")} else knitr::asis_output("\\pagebreak")`

<br>

```{r tab-habitat-summary-198066}
tab_hab_summary %>% 
  filter(Site  == my_site |
           Site == my_site2) %>% 
  # select(-Site) %>% 
  fpr::fpr_kable(caption_text = paste0('Summary of habitat details for PSCIS crossing ', my_site, ' and ', my_site2, '.'),
                 scroll = F) 

```

<br>



```{r photo-198066-01-prep, eval=T}
my_photo1 = fpr::fpr_photo_pull_by_str(str_to_pull = '_d1_')

my_caption1 = paste0('Typical habitat downstream of PSCIS crossing ', my_site, '.')


# fpr::fpr_photo_flip(site_id = 1802488, str_to_pull = '6257')

```

```{r photo-198066-01, fig.cap= my_caption1, out.width = photo_width, eval=gitbook_on}
grid::grid.raster(jpeg::readJPEG(my_photo1))
```

<br>

```{r photo-198066-02-prep}
my_photo2 = fpr::fpr_photo_pull_by_str(str_to_pull = '_d2_')

my_caption2 = paste0('Habitat on side channel of Bulkley River downstream of crossing ', my_site, '.')
```

```{r photo-198066-02, fig.cap= my_caption2, out.width = photo_width, eval=gitbook_on}
grid::grid.raster(jpeg::readJPEG(my_photo2))

```

<br>

```{r photo-198066-d01, fig.cap = my_caption, fig.show="hold", out.width= c("49.5%","1%","49.5%"), eval=identical(gitbook_on, FALSE)}

my_caption <- paste0('Left: ', my_caption1, ' Right: ', my_caption2)

knitr::include_graphics(my_photo1)
knitr::include_graphics("fig/pixel.png")
knitr::include_graphics(my_photo2)
```


```{r photo-198066-03-prep}
my_photo1 = fpr::fpr_photo_pull_by_str(str_to_pull = '_u1_')

my_caption1 = paste0('Small drop (50cm high) located ~20m upstream of PSCIS crossing ', my_site, '.')
```

```{r photo-198066-03, fig.cap= my_caption1, out.width = photo_width, eval=gitbook_on}
grid::grid.raster(jpeg::readJPEG(my_photo1))
```



<br>

```{r photo-198066-04-prep}
my_photo2 = fpr::fpr_photo_pull_by_str(str_to_pull = '_u2_')

my_caption2 = paste0('Habitat immediately upstream of PSCIS crossing ',  my_site, ' that flows through a hay field within an excavated trench for approximately 350m.')

```

```{r photo-198066-04, fig.cap= my_caption2, out.width = photo_width, eval=gitbook_on}
grid::grid.raster(jpeg::readJPEG(my_photo2))
```

```{r photo-198066-d02, fig.cap = my_caption, fig.show="hold", out.width= c("49.5%","1%","49.5%"), eval=identical(gitbook_on, FALSE)}

my_caption <- paste0('Left: ', my_caption1, ' Right: ', my_caption2)

knitr::include_graphics(my_photo1)
knitr::include_graphics("fig/pixel.png")
knitr::include_graphics(my_photo2)
```
